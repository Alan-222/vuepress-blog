(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{481:function(e,n,t){"use strict";t.r(n);var a=t(2),s=Object(a.a)({},(function(){var e=this,n=e._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h2",{attrs:{id:"å‰è¨€"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[e._v("#")]),e._v(" å‰è¨€")]),e._v(" "),n("p",[e._v("ä¸€èˆ¬è€Œè¨€ï¼Œåå°ç®¡ç†ç³»ç»Ÿéƒ½ä¼šæœ‰ä¸€ä¸ªç»Ÿä¸€çš„å¸ƒå±€ï¼Œå…¶ä¸­å¯ä»¥åŒ…å«å¤´éƒ¨ã€ä¾§è¾¹æ å’Œå†…å®¹åŒºåŸŸã€‚åœ¨æœ¬ç³»ç»Ÿä¸­ï¼Œå¤´éƒ¨åŒ…å«å·¦éƒ¨æ“ä½œåŒºå’Œç”¨æˆ·ä¿¡æ¯åŒºåŸŸï¼Œä¾§è¾¹æ å±•ç¤ºèœå•å’Œç³»ç»Ÿæ ‡é¢˜åŒºåŸŸï¼Œå†…å®¹åŒºåŸŸå°±æ˜¯å±•ç¤º Layout è·¯ç”±çš„å­è·¯ç”±é¡µé¢ï¼Œæ”¾ç½®"),n("Outlet"),e._v("æ ‡ç­¾ç‚¹å‡»èœå•åèƒ½å±•ç¤ºå¯¹åº”å­è·¯ç”±é¡µé¢ã€‚")],1),e._v(" "),n("h2",{attrs:{id:"layout-æ¨¡å—"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#layout-æ¨¡å—"}},[e._v("#")]),e._v(" Layout æ¨¡å—")]),e._v(" "),n("p",[e._v("æ‰€éœ€è¦çš„å¤´éƒ¨ã€ä¾§è¾¹æ ã€å†…å®¹åŒºåŸŸç»“æ„å¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤º")]),e._v(" "),n("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9f816b0ef4124bfea66d61634fd09186~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1104&h=723&s=19885&e=png&b=ffffff",alt:"img.png",referrerpolicy:"no-referrer"}}),e._v(" "),n("p",[e._v("æˆ‘ä»¬å…ˆæ¥å®ç°å¤–éƒ¨æ¡†æ¶ã€‚")]),e._v(" "),n("h3",{attrs:{id:"æ¡†æ¶å®ç°"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ¡†æ¶å®ç°"}},[e._v("#")]),e._v(" æ¡†æ¶å®ç°")]),e._v(" "),n("p",[e._v("è¿™é‡Œ Ant Design æœ‰ç°æˆçš„ Layout ç»„ä»¶ï¼Œæˆ‘ä»¬æŒ‘é€‰ä¸€ä¸ªå¸ƒå±€ç›´æ¥ç”¨å®ƒæä¾›çš„åšä¸‹æ”¹é€ ã€‚")]),e._v(" "),n("p",[n("strong",[e._v("src/Layout/index.jsx")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import React, { useState } from 'react'\nimport { MenuFoldOutlined, MenuUnfoldOutlined, DashboardFilled } from '@ant-design/icons'\nimport { Layout, Menu, Button, theme, Switch } from 'antd'\nimport './Layout.scss'\nconst { Header, Sider, Content } = Layout\nâ€‹\nconst LayoutApp = () => {\n  const [collapsed, setCollapsed] = useState(false)\n  const {\n Â   token: { colorBgContainer }\n  } = theme.useToken()\n  // ä¾§è¾¹æ ä¸»é¢˜æ¨¡å¼\n  const [themeVari, setThemeVari] = useState('dark')\n  // åˆ‡æ¢ä¾§è¾¹æ ä¸»é¢˜é¢œè‰²\n  const changeTheme = (value) => {\n Â   setThemeVari(value ? 'light' : 'dark')\n  }\n  return (\n Â   <Layout className=\"layout\">\n Â  Â   <Sider trigger={null} collapsible collapsed={collapsed} theme={themeVari}>\n Â  Â  Â   <div className=\"layout-logo-vertical\" style={{ color: themeVari === 'dark' ? '#fff' : '#000' }}>\n Â  Â  Â  Â   <span className=\"layout-logo\">\n Â  Â  Â  Â  Â   {' '}\n Â  Â  Â  Â  Â   <DashboardFilled />\n Â  Â  Â  Â   </span>\n Â  Â  Â  Â   {!collapsed && <span>react-antd5-admin</span>}\n Â  Â  Â   </div>\n Â  Â  Â   <Switch\n Â  Â  Â  Â   className=\"sider-switch\"\n Â  Â  Â  Â   checkedChildren=\"â˜€\"\n Â  Â  Â  Â   unCheckedChildren=\"ğŸŒ™\"\n Â  Â  Â  Â   onChange={changeTheme}\n Â  Â  Â  Â   style={{ transform: collapsed ? 'translateX(15px)' : 'translateX(75px)' }}\n Â  Â  Â   />\n Â  Â  Â   <Menu theme={themeVari} mode=\"inline\" defaultSelectedKeys={[]} items={[]} />\n Â  Â   </Sider>\n Â  Â   <Layout>\n Â  Â  Â   <Header\n Â  Â  Â  Â   style={{\n Â  Â  Â  Â  Â   padding: 0,\n Â  Â  Â  Â  Â   background: colorBgContainer\n Â  Â  Â  Â   }}>\n Â  Â  Â  Â   <Button\n Â  Â  Â  Â  Â   type=\"text\"\n Â  Â  Â  Â  Â   icon={collapsed ? <MenuUnfoldOutlined /> : <MenuFoldOutlined />}\n Â  Â  Â  Â  Â   onClick={() => setCollapsed(!collapsed)}\n Â  Â  Â  Â  Â   style={{\n Â  Â  Â  Â  Â  Â   fontSize: '16px',\n Â  Â  Â  Â  Â  Â   width: 64,\n Â  Â  Â  Â  Â  Â   height: 64\n Â  Â  Â  Â  Â   }}\n Â  Â  Â  Â   />\n Â  Â  Â   </Header>\n Â  Â  Â   <Content\n Â  Â  Â  Â   style={{\n Â  Â  Â  Â  Â   margin: '24px 16px',\n Â  Â  Â  Â  Â   padding: 24,\n Â  Â  Â  Â  Â   minHeight: 280,\n Â  Â  Â  Â  Â   background: colorBgContainer\n Â  Â  Â  Â   }}>\n Â  Â  Â  Â   Content\n Â  Â  Â   </Content>\n Â  Â   </Layout>\n Â   </Layout>\n  )\n}\nexport default LayoutApp\n")])])]),n("p",[e._v("æ•´ä½“å¤–è§‚å¦‚ä¸‹å›¾ï¼š")]),e._v(" "),n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/40dd09936f2947d386efbe86637298f3~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2559&h=1206&s=28380&e=png&b=fefefe",alt:"img.png",referrerpolicy:"no-referrer"}}),e._v(" "),n("p",[e._v("å®Œæˆäº†æ¡†æ¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å®ç°å„ä¸ªåŠŸèƒ½æ¨¡å—")]),e._v(" "),n("h3",{attrs:{id:"å¤´éƒ¨åŒºåŸŸ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å¤´éƒ¨åŒºåŸŸ"}},[e._v("#")]),e._v(" å¤´éƒ¨åŒºåŸŸ")]),e._v(" "),n("p",[e._v("å·¦éƒ¨çš„æ“ä½œæŒ‰é’®åŒºç°åœ¨å°±æ˜¯ä¼¸ç¼©ä¾§è¾¹æ çš„æŒ‰é’®ï¼Œå³ä¾§ç”¨æˆ·ä¿¡æ¯åŒºåŸŸä¸»è¦å°±æ˜¯ä¸€ä¸ªç”¨æˆ·å¤´åƒï¼Œæ‚¬æµ®å‡ºç°ä¸‹æ‹‰æ¡†å±•ç¤ºä¿®æ”¹å¯†ç ã€é€€å‡ºç™»å½•çš„åŠŸèƒ½æŒ‰é’®ã€‚")]),e._v(" "),n("h4",{attrs:{id:"ç”¨æˆ·å¤´åƒå±•ç¤º"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç”¨æˆ·å¤´åƒå±•ç¤º"}},[e._v("#")]),e._v(" ç”¨æˆ·å¤´åƒå±•ç¤º")]),e._v(" "),n("p",[e._v("ç”¨æˆ·çš„å¤´åƒæˆ‘ä»¬ç›´æ¥åœ¨å…¨å±€çŠ¶æ€ä¸­ç”¨æˆ·åˆ‡ç‰‡çš„"),n("code",[e._v("userinfo")]),e._v("å­—æ®µä¸­å»å–ï¼Œè‹¥æœ‰çš„è¯å±•ç¤ºï¼Œæ— å°±å±•ç¤ºä¸€å¼ é»˜è®¤å›¾ç‰‡ã€‚")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("  // ç”¨æˆ·å¤´åƒ\nconst avatar = useSelector(state=>state.user.userinfo.avatar)\n...\n<Header\n  style={{padding: 0,background: colorBgContainer,\ndisplay: 'flex',justifyContent: 'space-between'\n}}>\n...\n<div className=\"header-right\">\n<Space>\n  <img\n Â   src={avatar || require('@/assets/images/avatar/default_avatar.jpg')}\n Â   className=\"user-icon\"\n Â   alt=\"avatar\"\n  />\n  <DownOutlined />\n</Space>\n</div>\n</Header>\n")])])]),n("h4",{attrs:{id:"ä¸‹æ‹‰èœå•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‹æ‹‰èœå•"}},[e._v("#")]),e._v(" ä¸‹æ‹‰èœå•")]),e._v(" "),n("p",[e._v("ä¸‹æ‹‰èœå•ç›´æ¥ç”¨"),n("code",[e._v("Antd")]),e._v("æœ‰ä¸€ä¸ª"),n("code",[e._v("Dropdown")]),e._v("ç»„ä»¶åŒ…è£¹ä¸Šé¢çš„ç”¨æˆ·å¤´åƒ")]),e._v(" "),n("blockquote",[n("p",[n("code",[e._v("Dropdown")])]),e._v(" "),n("ul",[n("li",[n("p",[e._v("menuï¼šèœå•é…ç½®é¡¹ï¼Œå…¶ä¸­ items ä¸ºèœå•é¡¹æ•°ç»„")]),e._v(" "),n("ul",[n("li",[n("p",[e._v("itemsï¼šåŒ…å«èœå•é¡¹ item çš„é…ç½®æ•°ç»„")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("key")]),e._v("ï¼šèœå•é¡¹çš„å”¯ä¸€æ ‡å¿—")]),e._v(" "),n("li",[n("code",[e._v("label")]),e._v("ï¼šèœå•é¡¹æ ‡é¢˜")])])])])]),e._v(" "),n("li",[n("p",[e._v("placementï¼š èœå•å¼¹å‡ºä½ç½®ï¼š"),n("code",[e._v("bottom")]),e._v(" "),n("code",[e._v("bottomLeft")]),e._v(" "),n("code",[e._v("bottomRight")]),e._v(" "),n("code",[e._v("top")]),e._v(" "),n("code",[e._v("topLeft")]),e._v(" "),n("code",[e._v("topRight")])])])])]),e._v(" "),n("p",[e._v("æˆ‘ä»¬å…ˆæŒ‰ç…§æ ¼å¼è®¾ç½®ä¸€ä¸ªèœå•æ•°ç»„")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("/** ä¸‹æ‹‰èœå• */\n// ä¸‹æ‹‰èœå•é¡¹æ•°ç»„\nconst dropdownMenuItems = [\n{\n  key: '1',\n  label: (\n Â   <div onClick={() => console.log('ä¸ªäººä¸­å¿ƒ')}>\n Â  Â   <UserOutlined /> ä¸ªäººä¸­å¿ƒ\n Â   </div>\n  )\n},\n{\n  key: '2',\n  label: (\n Â   <Popconfirm\n Â  Â   onConfirm={() => console.log('é‡ç½®å¯†ç ')}\n Â  Â   title=\"æ˜¯å¦ç¡®è®¤é‡ç½®å¯†ç ï¼Ÿ\"\n Â  Â   okText=\"é‡ç½®\"\n Â  Â   cancelText=\"å–æ¶ˆ\">\n Â  Â   <UndoOutlined /> é‡ç½®å¯†ç \n Â   </Popconfirm>\n  )\n},\n{\n  key: '3',\n  label: (\n Â   <Popconfirm onConfirm={() => console.log('é€€å‡ºç™»å½•')} title=\"æ˜¯å¦ç¡®è®¤é€€å‡ºï¼Ÿ\" okText=\"é€€å‡º\" cancelText=\"å–æ¶ˆ\">\n Â  Â   <LogoutOutlined /> é€€å‡ºç™»å½•\n Â   </Popconfirm>\n  )\n}]\n")])])]),n("p",[e._v("ç„¶åæ¨¡æ¿ç»“æ„æ·»åŠ  DropDown")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('<div className="header-right">\n<Dropdown menu={{ items: dropdownMenuItems }} placement="bottomRight">\n  <Space>\n Â   ...\n  </Space>\n</Dropdown>\n</div>\n')])])]),n("p",[e._v("å®Œæˆåå±•ç¤ºæ•ˆæœå¦‚ä¸‹æ‰€ç¤º")]),e._v(" "),n("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d2308c259f5e4e57ab3fcaa604869e14~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=231&h=277&s=12543&e=png&b=fbfafa",alt:"img.png",referrerpolicy:"no-referrer"}}),e._v(" "),n("p",[e._v("æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®Œæˆå„ä¸ªåŠŸèƒ½ï¼Œä¸ªäººä¸­å¿ƒå’Œé‡ç½®å¯†ç éƒ½æ˜¯å¼¹çª—è¿›è¡Œè¡¨å•æ“ä½œï¼Œå› ä¸ºå¼¹çª—æ˜¯é€šç”¨çš„ç»„ä»¶ï¼Œæˆ‘ä»¬å°±å…ˆå°è£…ä¸€ä¸ªè‡ªå®šä¹‰å¼¹çª—ã€‚")]),e._v(" "),n("h4",{attrs:{id:"è‡ªå®šä¹‰å¼¹çª—å°è£…"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#è‡ªå®šä¹‰å¼¹çª—å°è£…"}},[e._v("#")]),e._v(" è‡ªå®šä¹‰å¼¹çª—å°è£…")]),e._v(" "),n("p",[e._v("å¼¹çª—çš„å°è£…æˆ‘ä»¬åªå°è£…æœ€åŸºæœ¬çš„å¼¹çª—ç»„ä»¶ï¼Œç„¶ååªå‘å¤–æš´éœ²ä¸€ä¸ªå¼¹çª—æ˜¾éšçš„æ–¹æ³•ä¾›å¤–éƒ¨ç»„ä»¶ä½¿ç”¨ã€‚")]),e._v(" "),n("p",[n("strong",[e._v("src/components/CustomModal/index.jsx")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import React, { useState, useImperativeHandle, forwardRef } from 'react'\nimport { Modal } from 'antd'\n// forwardRef : ä¼ é€’å¼¹çª—ç»„ä»¶çš„ref\nconst CustomModal = forwardRef(({ title, children }, ref) => {\n  const [isModalOpen, setIsModalOpen] = useState(false)\n  // å–æ¶ˆäº‹ä»¶\n  const handleCancel = () => {\n Â   setIsModalOpen(false)\n  }\n  // useImperativeHandleï¼šè‡ªå®šä¹‰çˆ¶ç»„ä»¶ref.currentæ¥æ”¶åˆ°çš„æ–¹æ³•\n  useImperativeHandle(\n Â   ref,\n Â   () => ({\n Â  Â   toggleShowStatus: (status) => {\n Â  Â  Â   /** æ”¹å˜çŠ¶æ€ */\n Â  Â  Â   setIsModalOpen(status)\n Â  Â   }\n Â   }),\n Â   []\n  )\nâ€‹\n  return (\n Â   <Modal title={title} open={isModalOpen} footer={null} onCancel={handleCancel}>\n Â  Â   {children}\n Â   </Modal>\n  )\n})\nexport default CustomModal\n")])])]),n("blockquote",[n("p",[n("code",[e._v("useImperativeHandle(ref, createHandle, dependencies?)")])]),e._v(" "),n("p",[e._v("ä½œç”¨ï¼šåœ¨ç»„ä»¶é¡¶å±‚é€šè¿‡è°ƒç”¨ "),n("code",[e._v("useImperativeHandle")]),e._v(" æ¥è‡ªå®šä¹‰ ref æš´éœ²å‡ºæ¥çš„å¥æŸ„ï¼ˆé¿å…çˆ¶ç»„ä»¶ç›´æ¥è®¿é—®åˆ°å­ç»„ä»¶ä¸­çš„ DOM èŠ‚ç‚¹ï¼‰ï¼š")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("ref")]),e._v("ï¼šè¯¥ "),n("code",[e._v("ref")]),e._v(" æ˜¯ä½ ä»æ¸²æŸ“å‡½æ•°ä¸­è·å¾—çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚")]),e._v(" "),n("li",[n("code",[e._v("createHandle")]),e._v("ï¼šè¯¥å‡½æ•°æ— éœ€å‚æ•°ï¼Œå®ƒè¿”å›ä½ æƒ³è¦æš´éœ²çš„ ref çš„å¥æŸ„ã€‚è¯¥å¥æŸ„å¯ä»¥åŒ…å«ä»»ä½•ç±»å‹ã€‚é€šå¸¸ï¼Œä½ ä¼šè¿”å›ä¸€ä¸ªåŒ…å«ä½ æƒ³æš´éœ²çš„æ–¹æ³•çš„å¯¹è±¡ã€‚")]),e._v(" "),n("li",[e._v("å¯é€‰çš„"),n("code",[e._v("dependencies")]),e._v("ï¼šå¥æŸ„ä¸­çš„ä¾èµ–é¡¹ï¼Œå˜åŒ–åˆ™å¥æŸ„é‡æ–°æ‰§è¡Œ")])])]),e._v(" "),n("h4",{attrs:{id:"ä¸ªäººä¸­å¿ƒçš„å®ç°"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ªäººä¸­å¿ƒçš„å®ç°"}},[e._v("#")]),e._v(" ä¸ªäººä¸­å¿ƒçš„å®ç°")]),e._v(" "),n("p",[e._v("å¼¹çª—å·²ç»å°è£…å®Œæ¯•ï¼Œæˆ‘ä»¬ç°åœ¨å†é¢å¤–åˆ›å»ºä¸€ä¸ªç»„ä»¶å»æ„å»ºå†…éƒ¨è¡¨å•ã€‚ä¸ªäººä¿¡æ¯ä¸­éœ€è¦ä¿®æ”¹çš„å¤´åƒã€ç”¨æˆ·åã€æ˜µç§°ã€é‚®ç®±ä½œä¸ºè¡¨å•é¡¹ã€‚è¿™é‡Œç”¨æˆ·åã€æ˜µç§°ã€é‚®ç®±ç­‰æ–‡æœ¬å­—æ®µä¸ç™»å½•è¡¨å•ç±»ä¼¼ï¼Œåœ¨æ­¤ä¸å†å¤šåšèµ˜è¿°ã€‚æˆ‘ä»¬ä¾¿ä¸“æ³¨äºå¤´åƒçš„ä¿®æ”¹ã€‚å¤´åƒçš„ä¿®æ”¹ç”¨åˆ°çš„æ˜¯"),n("code",[e._v("upload")]),e._v("ä¸Šä¼ ç»„ä»¶ã€‚ä½†æˆ‘ä»¬é¦–å…ˆå¾—è·å–åˆ°ç”¨æˆ·çš„ä¿¡æ¯å›æ˜¾ã€‚")]),e._v(" "),n("h5",{attrs:{id:"_1-å›æ˜¾ä¿¡æ¯"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-å›æ˜¾ä¿¡æ¯"}},[e._v("#")]),e._v(" 1.å›æ˜¾ä¿¡æ¯")]),e._v(" "),n("p",[n("strong",[e._v("src/Layout/components/UserCenterForm.jsx")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("// å¯¼å…¥api\nimport userApi from '@/api/user'\n...\n// è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„id\nconst user_id = useSelector((state) => state.user.userinfo.user_id)\n// è¡¨å•ç»„ä»¶å®ä¾‹\nconst [form] = Form.useForm()\n// uploadç»„ä»¶å›æ˜¾å›¾ç‰‡\nconst [imageUrl, setImageUrl] = useState()\nuseEffect(() => {\n// è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯å›æ˜¾\nconst fetchUserInfo = async () => {\n  const {\n Â   data: { name, nickname, email, avatar }\n  } = await userApi.center.get(user_id)\n  form.setFieldsValue({\n Â   name,\n Â   nickname,\n Â   email\n  })\n  if (avatar) setImageUrl(process.env.React_APP_IMG_API + '/' + avatar)\n}\nfetchUserInfo()\n}, [form, user_id])\n")])])]),n("h5",{attrs:{id:"_2-è®¾ç½®-upload-ç»„ä»¶"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-è®¾ç½®-upload-ç»„ä»¶"}},[e._v("#")]),e._v(" 2.è®¾ç½® upload ç»„ä»¶")]),e._v(" "),n("p",[e._v("åšæ³•ä¸€æ ·ï¼Œç›´æ¥å»å®˜ç½‘æ‰¾ upload ç»„ä»¶ç”¨æˆ·å¤´åƒçš„æ¡ˆä¾‹ç²˜è¿‡æ¥")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const getBase64 = (img, callback) => {\n  const reader = new FileReader()\n  reader.addEventListener('load', () => callback(reader.result))\n  reader.readAsDataURL(img)\n}\nconst beforeUpload = (file) => {\n  const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png'\n  if (!isJpgOrPng) {\n Â   message.error('You can only upload JPG/PNG file!')\n  }\n  const isLt2M = file.size / 1024 / 1024 < 2\n  if (!isLt2M) {\n Â   message.error('Image must smaller than 2MB!')\n  }\n  return isJpgOrPng && isLt2M\n}\nconst UserCenterForm = (props) => {\n  // è·å–token\n  const token = useSelector((state) => state.user.token)\n  const [loading, setLoading] = useState(false)\n Â   /** å›¾ç‰‡ä¸Šä¼ å‚æ•°åŠæ–¹æ³• */\n  const uploadUrl =\n Â   process.env.NODE_ENV === 'development' ? '/api/user/myInfo/updateAvatar' : '/user/myInfo/updateAvatar'\n  const handleChange = (info) => {\n Â   if (info.file.status === 'uploading') {\n Â  Â   setLoading(true)\n Â  Â   return\n Â   }\n Â   if (info.file.status === 'done') {\n Â  Â   // Get this url from response in real world.\n Â  Â   getBase64(info.file.originFileObj, (url) => {\n Â  Â  Â   setLoading(false)\n Â  Â  Â   setImageUrl(url)\n Â  Â   })\n Â   }\n  }\n  const uploadButton = (\n Â   <div>\n Â  Â   {loading ? <LoadingOutlined /> : <PlusOutlined />}\n Â  Â   <div\n Â  Â  Â   style={{\n Â  Â  Â  Â   marginTop: 8\n Â  Â  Â   }}>\n Â  Â  Â   Upload\n Â  Â   </div>\n Â   </div>\n  )\n  return (\n Â   <>\n Â  Â   <div style={{ marginBottom: 10 }}>å¤´åƒ</div>\n Â  Â   <Upload\n Â  Â  Â   name=\"avatar\"\n Â  Â  Â   listType=\"picture-circle\"\n Â  Â  Â   className=\"avatar-uploader\"\n Â  Â  Â   showUploadList={false}\n Â  Â  Â   action={uploadUrl}\n Â  Â  Â   headers={{ Authorization: token }}\n Â  Â  Â   beforeUpload={beforeUpload}\n Â  Â  Â   onChange={handleChange}\n Â  Â  Â   style={{ textAlign: 'center' }}>\n Â  Â  Â   {imageUrl ? (\n Â  Â  Â  Â   <img\n Â  Â  Â  Â  Â   src={imageUrl}\n Â  Â  Â  Â  Â   alt=\"avatar\"\n Â  Â  Â  Â  Â   style={{\n Â  Â  Â  Â  Â  Â   width: '100%'\n Â  Â  Â  Â  Â   }}\n Â  Â  Â  Â   />\n Â  Â  Â   ) : (\n Â  Â  Â  Â   uploadButton\n Â  Â  Â   )}\n Â  Â   </Upload>\n Â  Â   {/* å…¶ä½™è¡¨å•é¡¹ */}\n Â  Â   <Form ...>\n Â  Â   </Form>\n}\n")])])]),n("p",[e._v("3.æ”¾ç½®è¯¥ç»„ä»¶åˆ°å¼¹çª—é‡Œ")]),e._v(" "),n("p",[e._v("é¦–å…ˆæˆ‘ä»¬è¦å¼•å…¥"),n("code",[e._v("useRef hook")]),e._v("æ¥æ¥æ”¶å­ç»„ä»¶ä¼ é€’çš„å¼¹çª—æ˜¾éšçš„æ–¹æ³•ï¼Œç„¶åè®¾ç½®ä¸€ä¸ªæ–¹æ³•æ“æ§ã€‚å…¶æ¬¡è¦ä¼ é€’ç»™å†…éƒ¨è¡¨å•ç»„ä»¶ä»¥ä¾¿å…¶èƒ½å…³é—­å¼¹çª—ã€‚")]),e._v(" "),n("p",[n("strong",[e._v("src/Layout/index.jsx")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("...\nimport {useRef} from 'React'\nimport UserCenterForm from './components/UserCenterForm'\n...\n/** ä¸ªäººä¸­å¿ƒ */\nconst userCenterRef = useRef()\nconst toggleCenterStatus = (status) => {\n  userCenterRef.current.toggleShowStatus(status)\n}\n...\n<CustomModal title=\"ä¸ªäººä¸­å¿ƒ\" ref={userCenterRef}>\n  <UserCenterForm toggleCenterStatus={toggleCenterStatus} />\n</CustomModal>\n")])])]),n("p",[e._v("ä¸ªäººä¸­å¿ƒå¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼Œå…³é”®æ­¥éª¤å°±æ˜¯ 1.å°è£…å¼¹çª—ç»„ä»¶ 2.ç¼–å†™å†…éƒ¨è¡¨å•ç»„ä»¶ 3.ç”¨å¼¹çª—ç»„ä»¶æš´éœ²çš„æ–¹æ³•æ§åˆ¶å¼¹çª—æ˜¾éšï¼Œé‡ç½®å¯†ç ä¹Ÿä¸æ­¤ç±»ä¼¼ï¼Œå°±ä¸å†å¤šå†™äº†ã€‚æœ€åæˆ‘ä»¬çœ‹ä¸€ä¸‹æ•ˆæœå›¾")]),e._v(" "),n("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3c47dc1dd204423aab4575324f3a7a3d~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1809&h=1197&s=46212&e=png&b=8b8b8b",alt:"img.png",referrerpolicy:"no-referrer"}}),e._v(" "),n("h4",{attrs:{id:"é€€å‡ºç™»å½•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#é€€å‡ºç™»å½•"}},[e._v("#")]),e._v(" é€€å‡ºç™»å½•")]),e._v(" "),n("p",[e._v("é€€å‡ºç™»å½•å°±æ˜¯ç¡®è®¤é€€å‡ºç™»å½•åï¼Œæ¸…ç©ºå…¨å±€çŠ¶æ€åŠæµè§ˆå™¨å­˜å‚¨ä¸­çš„"),n("code",[e._v("token")]),e._v("å’Œ"),n("code",[e._v("refreshToken")]),e._v("ã€‚è¿™äº›æˆ‘ä»¬ä¹‹å‰å·²ç»å†™åœ¨ç”¨æˆ·åˆ‡ç‰‡çš„ reducers é…ç½®é¡¹ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥åˆ†å‘è°ƒç”¨å³å¯ã€‚ç„¶åæˆ‘ä»¬è¿˜å¾—åŠ ä¸ªç¡®è®¤æ“ä½œï¼Œé˜²æ­¢ç”¨æˆ·è¯¯è§¦ã€‚")]),e._v(" "),n("p",[n("strong",[e._v("src/Layout/index.jsx")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('...\n/** ä¸‹æ‹‰èœå• */\n// ä¸‹æ‹‰èœå•é¡¹æ•°ç»„\nconst dropdownMenuItems = [\n ...\n Â  Â  {\n Â  Â   key: \'3\',\n Â  Â   label: (\n Â  Â  Â   <Popconfirm onConfirm={() => handleLogout()} title="æ˜¯å¦ç¡®è®¤é€€å‡ºï¼Ÿ" okText="é€€å‡º" cancelText="å–æ¶ˆ">\n Â  Â  Â  Â   <LogoutOutlined /> é€€å‡ºç™»å½•\n Â  Â  Â   </Popconfirm>\n Â  Â   )\n Â   }\n]\n')])])]),n("p",[e._v("å†ç¼–å†™å¯¹åº”"),n("code",[e._v("handleLogout")]),e._v("æ–¹æ³•")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import { logout } from '@/store/reducers/userSlice'\n...\n// é€€å‡ºç™»å½•\nconst handleLogout = () => {\n  dispatch(logout())\n  navigate('/login')\n}\n")])])]),n("h2",{attrs:{id:"ä»£ç "}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä»£ç "}},[e._v("#")]),e._v(" ä»£ç ")]),e._v(" "),n("p",[e._v("ä¸Šè¿°å®ç°çš„ä»£ç éƒ½æ”¾åœ¨"),n("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FAlan-222%2Freact-antd5-admin",title:"https://github.com/Alan-222/react-antd5-admin",target:"_blank",rel:"noopener noreferrer"}},[e._v("react-antd5-admin"),n("OutboundLink")],1),e._v("ï¼Œå¤§å®¶å¯è‡ªè¡ŒæŸ¥é˜…")])])}),[],!1,null,null,null);n.default=s.exports}}]);